"use strict";(self.webpackChunkFronted=self.webpackChunkFronted||[]).push([[44],{44:(b,y,s)=>{s.r(y),s.d(y,{AuthModule:()=>A});var u=s(9808),g=s(1083),m=s(9646),f=s(8505),n=s(5e3),h=s(7556),$=s(6196);let e=(()=>{class a{constructor(l,i,p){this.authService=l,this.companyService=i,this.router=p}canActivate(){return null===localStorage.getItem("token")?(0,m.of)(!0):this.authService.validarNoToken().pipe((0,f.b)(l=>{l?this.router.navigateByUrl("/auth/login"):"client"==this.authService.user.type?this.router.navigateByUrl("/clients/companies"):"admin"==this.authService.user.type?this.router.navigateByUrl("/admin"):"company"==this.authService.user.type?this.companyService.getCompanyByUser(this.authService.user._id).subscribe(i=>{this.router.navigateByUrl(i.ok?`/admin-companies/${i.company._id}`:"/auth/login")}):this.router.navigateByUrl("/auth/login")}))}canLoad(){return null===localStorage.getItem("token")?(0,m.of)(!0):this.authService.validarNoToken().pipe((0,f.b)(l=>{l?this.router.navigateByUrl("/auth/login"):"client"==this.authService.user.type?this.router.navigateByUrl("/clients/companies"):"admin"==this.authService.user.type?this.router.navigateByUrl("/admin"):"company"==this.authService.user.type?this.companyService.getCompanyByUser(this.authService.user._id).subscribe(i=>{this.router.navigateByUrl(i.ok?`/admin-companies/${i.company._id}`:"/auth/login")}):this.router.navigateByUrl("/auth/login")}))}canActivateChild(l,i){return this.authService.validarNoToken().pipe((0,f.b)(p=>{p||("client"==this.authService.user.type?this.router.navigateByUrl("/clients/companies"):"admin"==this.authService.user.type?this.router.navigateByUrl("/admin"):"company"==this.authService.user.type?this.companyService.getCompanyByUser(this.authService.user._id).subscribe(d=>{this.router.navigateByUrl(d.ok?`/admin-companies/${d.company._id}`:"/auth/login")}):this.router.navigateByUrl("/auth/login"))}))}}return a.\u0275fac=function(l){return new(l||a)(n.LFG(h.e),n.LFG($.J),n.LFG(g.F0))},a.\u0275prov=n.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var t=s(3075),r=s(5226),o=s.n(r),k=s(9103),v=s(7322),S=s(7531),C=s(5245),x=s(7423);function I(a,c){1&a&&(n.TgZ(0,"mat-hint",16),n._uU(1,"El correo no es valido "),n.qZA())}function B(a,c){1&a&&(n.TgZ(0,"mat-hint",16),n._uU(1,"El campo no es valido "),n.qZA())}const M=function(){return["/"]},U=[{path:"login",component:(()=>{class a{constructor(l,i,p,d,L){this.router=l,this.authService=i,this.fb=p,this.companyService=d,this.validatorService=L,this.hide=!0,this.myForm=this.fb.group({email:["",[t.kI.required,t.kI.pattern(this.validatorService.emailPattern)]],password:["",[t.kI.required]]})}ngOnInit(){}fieldNotValid(l){var i,p;return(null===(i=this.myForm.get(l))||void 0===i?void 0:i.invalid)&&(null===(p=this.myForm.get(l))||void 0===p?void 0:p.touched)}login(){if(!this.myForm.invalid){const{email:l,password:i}=this.myForm.value;this.authService.login(l,i).subscribe(p=>{if(!0===p)switch(this.authService.user.type){case"client":this.router.navigateByUrl("/clients");break;case"admin":this.router.navigateByUrl("/admin");break;case"company":this.companyService.getCompanyByUser(this.authService.user._id).subscribe(d=>{d.ok&&(localStorage.setItem("_web",d.company._id),this.companyService.setCurrentIDCompany=d.company._id,this.router.navigateByUrl(`/admin-companies/${d.company._id}`))})}else o().fire({background:"rgba(250,250,250,0.96)",title:"Oops!!",text:`${p}`,icon:"error",confirmButtonColor:"#3085d6"})})}}}return a.\u0275fac=function(l){return new(l||a)(n.Y36(g.F0),n.Y36(h.e),n.Y36(t.qu),n.Y36($.J),n.Y36(k.o))},a.\u0275cmp=n.Xpm({type:a,selectors:[["app-login"]],decls:26,vars:7,consts:[[1,"background","background-back"],[1,"background","background-transparent-black","d-flex","justify-content-center","align-items-center"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"form-auth","mx-auto","p-3","rounded","text-center","text-white"],[1,"col-12"],["src","../../../assets/Logo V3.png","routerLinkActive","router-link-active","alt","","width","150",1,"cursor-pointer",3,"routerLink"],[1,"mt-5","text-pink2","mb-4"],["appearance","legacy","color","accent"],["matInput","","formControlName","email","placeholder",""],["class","form-label form-text text-danger",4,"ngIf"],["appearance","legacy","color","accent",1,"lastInput"],[2,"overflow","visible"],["type","password","matInput","","formControlName","password",3,"type"],["matPrefix","",1,"me-2"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["type","submit",1,"btn","btn-purple","text-white","mt-5"],[1,"form-label","form-text","text-danger"]],template:function(l,i){1&l&&(n.TgZ(0,"div",0)(1,"div",1)(2,"form",2),n.NdJ("ngSubmit",function(){return i.login()}),n.TgZ(3,"div",3)(4,"div",4),n._UZ(5,"img",5),n.TgZ(6,"h1",6),n._uU(7,"Bienvenido"),n.qZA(),n.TgZ(8,"mat-form-field",7)(9,"mat-label"),n._uU(10,"Correo"),n.qZA(),n._UZ(11,"input",8),n.YNc(12,I,2,0,"mat-hint",9),n.qZA(),n.TgZ(13,"mat-form-field",10)(14,"mat-label",11),n._uU(15,"Contrase\xf1a"),n.qZA(),n._UZ(16,"input",12),n.TgZ(17,"mat-icon",13),n._uU(18,"lock"),n.qZA(),n.TgZ(19,"button",14),n.NdJ("click",function(){return i.hide=!i.hide}),n.TgZ(20,"mat-icon"),n._uU(21),n.qZA()(),n.YNc(22,B,2,0,"mat-hint",9),n.qZA(),n.TgZ(23,"p")(24,"button",15),n._uU(25,"Acceder"),n.qZA()()()()()()()),2&l&&(n.xp6(2),n.Q6J("formGroup",i.myForm),n.xp6(3),n.Q6J("routerLink",n.DdM(6,M)),n.xp6(7),n.Q6J("ngIf",i.fieldNotValid("email")),n.xp6(4),n.Q6J("type",i.hide?"password":"text"),n.xp6(5),n.Oqu(i.hide?"visibility_off":"visibility"),n.xp6(1),n.Q6J("ngIf",i.fieldNotValid("password")))},directives:[t._Y,t.JL,t.sg,g.Od,g.rH,v.KE,v.hX,S.Nt,t.Fj,t.JJ,t.u,u.O5,v.bx,C.Hw,v.qo,x.lW,v.R9],styles:[".background,.background-transparent-black,.background-back{width:100%;height:100vh;overflow-y:hidden;overflow-x:hidden}.background-back{background-position:center;background-repeat:no-repeat;background-size:cover}.background-transparent-black{background-color:#051d24cc}.form-auth{height:550px;width:450px;background-color:#8d1764b5}.form-auth mat-form-field{text-align:center;width:75%;margin-bottom:8px}.form-auth .lastInput{margin-bottom:5px}.form-auth mat-label{color:#f0a6e0;font-weight:500;font-size:19px}.background-back{background-image:url(Auth\\ 01.93f0c010ff2db46e.jpg)}.form-auth{background:linear-gradient(90deg,#5b003f 0%,#4e0036 48%,#3b0029 100%);height:500px;width:450px}.form-auth mat-label{height:100px;color:#bd1c90;font-weight:400;font-size:20px}.text-pink2{color:#e50f9d}\n"],encapsulation:2}),a})(),pathMatch:"full",canActivate:[e],canLoad:[e]},{path:"",redirectTo:"login",pathMatch:"full"}];let F=(()=>{class a{}return a.\u0275fac=function(l){return new(l||a)},a.\u0275mod=n.oAB({type:a}),a.\u0275inj=n.cJS({imports:[[g.Bz.forChild(U)],g.Bz]}),a})();var w=s(5578);let A=(()=>{class a{}return a.\u0275fac=function(l){return new(l||a)},a.\u0275mod=n.oAB({type:a}),a.\u0275inj=n.cJS({imports:[[u.ez,F,w.q,t.UX]]}),a})()},6196:(b,y,s)=>{s.d(y,{J:()=>n});var u=s(520),g=s(8505),m=s(2340),f=s(5e3);let n=(()=>{class h{constructor(e){this.http=e,this.currentIDCompany="",this.currentCompany={},this.url=`${m.N.baseUrl}/companies`,this.urlFile=`${m.N.baseUrl}/files`,this.urlProducts=`${m.N.baseUrl}/products`}get getAllCompany(){return this.http.get(this.url)}get getAllCompanyWithWebAndPages(){return this.http.get(`${this.url}/with-webs`)}get getCurrentIDCompany(){return this.currentIDCompany}set setCurrentIDCompany(e){this.currentIDCompany=e}get getCompany(){return this.currentCompany}set setCurrentCompany(e){this.currentCompany=e}getCompanyById(e){return this.http.get(`${this.url}/${e}`)}inicializatedCurrentData(e){this.getCompanyById(e).pipe((0,g.b)(t=>{this.currentCompany=t.company}))}getCompanyByUser(e){return this.http.get(`${this.url}/user/${e}`)}changeStateCompany(e){const t=(new u.WM).append("x-token",localStorage.getItem("token")||"");return this.http.put(`${this.url}/${e._id}`,{state:!e.state},{headers:t})}updateCompany(e,t){const r=(new u.WM).append("x-token",localStorage.getItem("token")||"");return this.http.put(`${this.url}/${e}`,t,{headers:r})}deleteCompany(e){const t=(new u.WM).append("x-token",localStorage.getItem("token")||"");return this.http.delete(`${this.url}/${e._id}`,{headers:t})}getCompanyProducts(e){return this.http.get(`${this.urlProducts}/${e}`)}newFile(e,t){const r=new FormData,o=(new u.WM).append("x-token",localStorage.getItem("token")||"");return r.append("baseName",String(t.baseName)),r.append("file",t.file),r.append("description",t.description),this.http.post(`${this.urlFile}/${e}`,r,{headers:o})}getFiles(e){return this.http.get(`${this.urlFile}/${e}`)}getFile(e,t){return this.http.get(`${this.urlFile}/${e}/${t}`)}updateFile(e,t,r){const o=(new u.WM).append("x-token",localStorage.getItem("token")||"");return this.http.put(`${this.urlFile}/${e}/${t}`,r,{headers:o})}deleteFile(e,t){const r=(new u.WM).append("x-token",localStorage.getItem("token")||"");return this.http.delete(`${this.urlFile}/${e}/${t}`,{headers:r})}addProduct(e){const t=new FormData,r=(new u.WM).append("x-token",localStorage.getItem("token")||"");return t.append("name",e.name),t.append("price",e.price),t.append("description",e.description),t.append("categories",e.categories),t.append("image",e.image),this.http.post(`${this.urlProducts}/${this.currentIDCompany}`,t,{headers:r})}deleteProduct(e){const t=(new u.WM).append("x-token",localStorage.getItem("token")||"");return this.http.delete(`${this.urlProducts}/${e}`,{headers:t})}updateProduct(e,t){const r=new FormData,o=(new u.WM).append("x-token",localStorage.getItem("token")||"");return t.name&&r.append("name",t.name),t.price&&r.append("price",t.price),t.description&&r.append("description",t.description),t.categories&&r.append("categories",t.categories),t.image&&r.append("image",t.image),this.http.put(`${this.urlProducts}/${this.getCurrentIDCompany}/${e}`,r,{headers:o})}getProductById(e){return this.http.get(`${this.urlProducts}/${this.getCurrentIDCompany}/${e}`)}getWeb(e){return this.http.get(`${this.url}/${e}/web`)}getWebWithPages(e){return this.http.get(`${this.url}/${e}/web-pages`)}updateMainPage(e,t){const r=(new u.WM).append("x-token",localStorage.getItem("token")||"");return this.http.put(`${this.url}/${e}/web`,{pageMain:t},{headers:r})}updateWeb(e,t){const r=(new u.WM).append("x-token",localStorage.getItem("token")||""),o=new FormData;return t.title&&o.append("title",t.title),t.keywords&&o.append("keywords",t.keywords),t.description&&o.append("description",t.description),t.cssExtra&&o.append("cssExtra",t.cssExtra),t.jsExtra&&o.append("jsExtra",t.jsExtra),t.genericHeaderHTML&&o.append("genericHeaderHTML",t.genericHeaderHTML),t.genericFooterHTML&&o.append("genericFooterHTML",t.genericFooterHTML),t.logo&&o.append("logo",t.logo),t.favicon&&o.append("favicon",t.favicon),this.http.put(`${this.url}/${e}/web`,o,{headers:r})}getPages(e){return this.http.get(`${this.url}/${e}/web/pages`)}getPage(e,t){return this.http.get(`${this.url}/${e}/web/pages/${t}`)}newPage(e,t){const r=(new u.WM).append("x-token",localStorage.getItem("token")||"");return this.http.post(`${this.url}/${e}/web/pages`,t,{headers:r})}deletePage(e,t){const r=(new u.WM).append("x-token",localStorage.getItem("token")||"");return this.http.delete(`${this.url}/${e}/web/pages/${t}`,{headers:r})}updatePage(e,t,r){const o=(new u.WM).append("x-token",localStorage.getItem("token")||"");return this.http.put(`${this.url}/${e}/web/pages/${t}`,r,{headers:o})}getBlocks(e,t){return this.http.get(`${this.url}/${e}/web/pages/${t}/blocks`)}getBlock(e,t,r){return this.http.get(`${this.url}/${e}/web/pages/${t}/blocks/${r}`)}newBlock(e,t,r){const o=(new u.WM).append("x-token",localStorage.getItem("token")||"");return this.http.post(`${this.url}/${e}/web/pages/${t}/blocks`,r,{headers:o})}updateBlock(e,t,r){const o=(new u.WM).append("x-token",localStorage.getItem("token")||"");return this.http.put(`${this.url}/${e}/web/pages/${t}/blocks/${r._id}`,r,{headers:o})}updateBlockWithID(e,t,r,o){const k=(new u.WM).append("x-token",localStorage.getItem("token")||"");return this.http.put(`${this.url}/${e}/web/pages/${t}/blocks/${r}`,o,{headers:k})}deleteBlock(e,t,r){const o=(new u.WM).append("x-token",localStorage.getItem("token")||"");return this.http.delete(`${this.url}/${e}/web/pages/${t}/blocks/${r}`,{headers:o})}}return h.\u0275fac=function(e){return new(e||h)(f.LFG(u.eN))},h.\u0275prov=f.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()}}]);