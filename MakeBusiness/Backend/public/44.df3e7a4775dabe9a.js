"use strict";(self.webpackChunkFronted=self.webpackChunkFronted||[]).push([[44],{44:(k,v,l)=>{l.r(v),l.d(v,{AuthModule:()=>F});var p=l(9808),g=l(1083),m=l(8505),n=l(5e3),y=l(7556),h=l(6196);let $=(()=>{class a{constructor(s,o,u){this.authService=s,this.companyService=o,this.router=u}canActivate(){return this.authService.validarNoToken().pipe((0,m.b)(s=>{s||("client"==this.authService.user.type?this.router.navigateByUrl("/clients/companies"):"admin"==this.authService.user.type?this.router.navigateByUrl("/admin"):"company"==this.authService.user.type?this.companyService.getCompanyByUser(this.authService.user._id).subscribe(o=>{this.router.navigateByUrl(o.ok?`/admin-companies/${o.company._id}`:"/auth/login")}):this.router.navigateByUrl("/auth/login"))}))}canLoad(){return this.authService.validarNoToken().pipe((0,m.b)(s=>{s||("client"==this.authService.user.type?this.router.navigateByUrl("/clients/companies"):"admin"==this.authService.user.type?this.router.navigateByUrl("/admin"):"company"==this.authService.user.type?this.companyService.getCompanyByUser(this.authService.user._id).subscribe(o=>{this.router.navigateByUrl(o.ok?`/admin-companies/${o.company._id}`:"/auth/login")}):this.router.navigateByUrl("/auth/login"))}))}canActivateChild(s,o){return this.authService.validarNoToken().pipe((0,m.b)(u=>{u||("client"==this.authService.user.type?this.router.navigateByUrl("/clients/companies"):"admin"==this.authService.user.type?this.router.navigateByUrl("/admin"):"company"==this.authService.user.type?this.companyService.getCompanyByUser(this.authService.user._id).subscribe(d=>{this.router.navigateByUrl(d.ok?`/admin-companies/${d.company._id}`:"/auth/login")}):this.router.navigateByUrl("/auth/login"))}))}}return a.\u0275fac=function(s){return new(s||a)(n.LFG(y.e),n.LFG(h.J),n.LFG(g.F0))},a.\u0275prov=n.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var t=l(3075),e=l(5226),r=l.n(e),i=l(9103),f=l(7322),b=l(7531),C=l(5245),S=l(7423);function x(a,c){1&a&&(n.TgZ(0,"mat-hint",16),n._uU(1,"El correo no es valido "),n.qZA())}function I(a,c){1&a&&(n.TgZ(0,"mat-hint",16),n._uU(1,"El campo no es valido "),n.qZA())}const M=function(){return["/"]},B=[{path:"login",component:(()=>{class a{constructor(s,o,u,d,A){this.router=s,this.authService=o,this.fb=u,this.companyService=d,this.validatorService=A,this.hide=!0,this.myForm=this.fb.group({email:["",[t.kI.required,t.kI.pattern(this.validatorService.emailPattern)]],password:["",[t.kI.required]]})}ngOnInit(){}fieldNotValid(s){var o,u;return(null===(o=this.myForm.get(s))||void 0===o?void 0:o.invalid)&&(null===(u=this.myForm.get(s))||void 0===u?void 0:u.touched)}login(){if(!this.myForm.invalid){const{email:s,password:o}=this.myForm.value;this.authService.login(s,o).subscribe(u=>{if(!0===u)switch(this.authService.user.type){case"client":this.router.navigateByUrl("/clients");break;case"admin":this.router.navigateByUrl("/admin");break;case"company":this.companyService.getCompanyByUser(this.authService.user._id).subscribe(d=>{d.ok&&(localStorage.setItem("_web",d.company._id),this.companyService.setCurrentIDCompany=d.company._id,this.router.navigateByUrl(`/admin-companies/${d.company._id}`))})}else r().fire({background:"rgba(250,250,250,0.96)",title:"Oops!!",text:`${u}`,icon:"error",confirmButtonColor:"#3085d6"})})}}}return a.\u0275fac=function(s){return new(s||a)(n.Y36(g.F0),n.Y36(y.e),n.Y36(t.qu),n.Y36(h.J),n.Y36(i.o))},a.\u0275cmp=n.Xpm({type:a,selectors:[["app-login"]],decls:26,vars:7,consts:[[1,"background","background-back"],[1,"background","background-transparent-black","d-flex","justify-content-center","align-items-center"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"form-auth","mx-auto","p-3","rounded","text-center","text-white"],[1,"col-12"],["src","../../../assets/Logo V3.png","routerLinkActive","router-link-active","alt","","width","150",1,"cursor-pointer",3,"routerLink"],[1,"mt-5","text-pink2","mb-4"],["appearance","legacy","color","accent"],["matInput","","formControlName","email","placeholder",""],["class","form-label form-text text-danger",4,"ngIf"],["appearance","legacy","color","accent",1,"lastInput"],[2,"overflow","visible"],["type","password","matInput","","formControlName","password",3,"type"],["matPrefix","",1,"me-2"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["type","submit",1,"btn","btn-purple","text-white","mt-5"],[1,"form-label","form-text","text-danger"]],template:function(s,o){1&s&&(n.TgZ(0,"div",0)(1,"div",1)(2,"form",2),n.NdJ("ngSubmit",function(){return o.login()}),n.TgZ(3,"div",3)(4,"div",4),n._UZ(5,"img",5),n.TgZ(6,"h1",6),n._uU(7,"Bienvenido"),n.qZA(),n.TgZ(8,"mat-form-field",7)(9,"mat-label"),n._uU(10,"Correo"),n.qZA(),n._UZ(11,"input",8),n.YNc(12,x,2,0,"mat-hint",9),n.qZA(),n.TgZ(13,"mat-form-field",10)(14,"mat-label",11),n._uU(15,"Contrase\xf1a"),n.qZA(),n._UZ(16,"input",12),n.TgZ(17,"mat-icon",13),n._uU(18,"lock"),n.qZA(),n.TgZ(19,"button",14),n.NdJ("click",function(){return o.hide=!o.hide}),n.TgZ(20,"mat-icon"),n._uU(21),n.qZA()(),n.YNc(22,I,2,0,"mat-hint",9),n.qZA(),n.TgZ(23,"p")(24,"button",15),n._uU(25,"Acceder"),n.qZA()()()()()()()),2&s&&(n.xp6(2),n.Q6J("formGroup",o.myForm),n.xp6(3),n.Q6J("routerLink",n.DdM(6,M)),n.xp6(7),n.Q6J("ngIf",o.fieldNotValid("email")),n.xp6(4),n.Q6J("type",o.hide?"password":"text"),n.xp6(5),n.Oqu(o.hide?"visibility_off":"visibility"),n.xp6(1),n.Q6J("ngIf",o.fieldNotValid("password")))},directives:[t._Y,t.JL,t.sg,g.Od,g.rH,f.KE,f.hX,b.Nt,t.Fj,t.JJ,t.u,p.O5,f.bx,C.Hw,f.qo,S.lW,f.R9],styles:[".background,.background-transparent-black,.background-back{width:100%;height:100vh;overflow-y:hidden;overflow-x:hidden}.background-back{background-position:center;background-repeat:no-repeat;background-size:cover}.background-transparent-black{background-color:#051d24cc}.form-auth{height:550px;width:450px;background-color:#8d1764b5}.form-auth mat-form-field{text-align:center;width:75%;margin-bottom:8px}.form-auth .lastInput{margin-bottom:5px}.form-auth mat-label{color:#f0a6e0;font-weight:500;font-size:19px}.background-back{background-image:url(Auth\\ 01.93f0c010ff2db46e.jpg)}.form-auth{background:linear-gradient(90deg,#5b003f 0%,#4e0036 48%,#3b0029 100%);height:500px;width:450px}.form-auth mat-label{height:100px;color:#bd1c90;font-weight:400;font-size:20px}.text-pink2{color:#e50f9d}\n"],encapsulation:2}),a})(),pathMatch:"full",canActivate:[$],canLoad:[$]},{path:"",redirectTo:"login",pathMatch:"full"}];let U=(()=>{class a{}return a.\u0275fac=function(s){return new(s||a)},a.\u0275mod=n.oAB({type:a}),a.\u0275inj=n.cJS({imports:[[g.Bz.forChild(B)],g.Bz]}),a})();var w=l(5578);let F=(()=>{class a{}return a.\u0275fac=function(s){return new(s||a)},a.\u0275mod=n.oAB({type:a}),a.\u0275inj=n.cJS({imports:[[p.ez,U,w.q,t.UX]]}),a})()},6196:(k,v,l)=>{l.d(v,{J:()=>y});var p=l(520),g=l(8505),m=l(2340),n=l(5e3);let y=(()=>{class h{constructor(t){this.http=t,this.currentIDCompany="",this.currentCompany={},this.url=`${m.N.baseUrl}/companies`,this.urlFile=`${m.N.baseUrl}/files`,this.urlProducts=`${m.N.baseUrl}/products`}get getAllCompany(){return this.http.get(this.url)}get getAllCompanyWithWebAndPages(){return this.http.get(`${this.url}/with-webs`)}get getCurrentIDCompany(){return this.currentIDCompany}set setCurrentIDCompany(t){this.currentIDCompany=t}get getCompany(){return this.currentCompany}set setCurrentCompany(t){this.currentCompany=t}getCompanyById(t){return this.http.get(`${this.url}/${t}`)}inicializatedCurrentData(t){this.getCompanyById(t).pipe((0,g.b)(e=>{this.currentCompany=e.company}))}getCompanyByUser(t){return this.http.get(`${this.url}/user/${t}`)}changeStateCompany(t){const e=(new p.WM).append("x-token",localStorage.getItem("token")||"");return this.http.put(`${this.url}/${t._id}`,{state:!t.state},{headers:e})}updateCompany(t,e){const r=(new p.WM).append("x-token",localStorage.getItem("token")||"");return this.http.put(`${this.url}/${t}`,e,{headers:r})}deleteCompany(t){const e=(new p.WM).append("x-token",localStorage.getItem("token")||"");return this.http.delete(`${this.url}/${t._id}`,{headers:e})}getCompanyProducts(t){return this.http.get(`${this.urlProducts}/${t}`)}newFile(t,e){const r=new FormData,i=(new p.WM).append("x-token",localStorage.getItem("token")||"");return r.append("baseName",String(e.baseName)),r.append("file",e.file),r.append("description",e.description),this.http.post(`${this.urlFile}/${t}`,r,{headers:i})}getFiles(t){return this.http.get(`${this.urlFile}/${t}`)}getFile(t,e){return this.http.get(`${this.urlFile}/${t}/${e}`)}updateFile(t,e,r){const i=(new p.WM).append("x-token",localStorage.getItem("token")||"");return this.http.put(`${this.urlFile}/${t}/${e}`,r,{headers:i})}deleteFile(t,e){const r=(new p.WM).append("x-token",localStorage.getItem("token")||"");return this.http.delete(`${this.urlFile}/${t}/${e}`,{headers:r})}addProduct(t){const e=new FormData,r=(new p.WM).append("x-token",localStorage.getItem("token")||"");return e.append("name",t.name),e.append("price",t.price),e.append("description",t.description),e.append("categories",t.categories),e.append("image",t.image),this.http.post(`${this.urlProducts}/${this.currentIDCompany}`,e,{headers:r})}deleteProduct(t){const e=(new p.WM).append("x-token",localStorage.getItem("token")||"");return this.http.delete(`${this.urlProducts}/${t}`,{headers:e})}updateProduct(t,e){const r=new FormData,i=(new p.WM).append("x-token",localStorage.getItem("token")||"");return e.name&&r.append("name",e.name),e.price&&r.append("price",e.price),e.description&&r.append("description",e.description),e.categories&&r.append("categories",e.categories),e.image&&r.append("image",e.image),this.http.put(`${this.urlProducts}/${this.getCurrentIDCompany}/${t}`,r,{headers:i})}getProductById(t){return this.http.get(`${this.urlProducts}/${this.getCurrentIDCompany}/${t}`)}getWeb(t){return this.http.get(`${this.url}/${t}/web`)}getWebWithPages(t){return this.http.get(`${this.url}/${t}/web-pages`)}updateMainPage(t,e){const r=(new p.WM).append("x-token",localStorage.getItem("token")||"");return this.http.put(`${this.url}/${t}/web`,{pageMain:e},{headers:r})}updateWeb(t,e){const r=(new p.WM).append("x-token",localStorage.getItem("token")||""),i=new FormData;return e.title&&i.append("title",e.title),e.keywords&&i.append("keywords",e.keywords),e.description&&i.append("description",e.description),e.cssExtra&&i.append("cssExtra",e.cssExtra),e.jsExtra&&i.append("jsExtra",e.jsExtra),e.genericHeaderHTML&&i.append("genericHeaderHTML",e.genericHeaderHTML),e.genericFooterHTML&&i.append("genericFooterHTML",e.genericFooterHTML),e.logo&&i.append("logo",e.logo),e.favicon&&i.append("favicon",e.favicon),this.http.put(`${this.url}/${t}/web`,i,{headers:r})}getPages(t){return this.http.get(`${this.url}/${t}/web/pages`)}getPage(t,e){return this.http.get(`${this.url}/${t}/web/pages/${e}`)}newPage(t,e){const r=(new p.WM).append("x-token",localStorage.getItem("token")||"");return this.http.post(`${this.url}/${t}/web/pages`,e,{headers:r})}deletePage(t,e){const r=(new p.WM).append("x-token",localStorage.getItem("token")||"");return this.http.delete(`${this.url}/${t}/web/pages/${e}`,{headers:r})}updatePage(t,e,r){const i=(new p.WM).append("x-token",localStorage.getItem("token")||"");return this.http.put(`${this.url}/${t}/web/pages/${e}`,r,{headers:i})}getBlocks(t,e){return this.http.get(`${this.url}/${t}/web/pages/${e}/blocks`)}getBlock(t,e,r){return this.http.get(`${this.url}/${t}/web/pages/${e}/blocks/${r}`)}newBlock(t,e,r){const i=(new p.WM).append("x-token",localStorage.getItem("token")||"");return this.http.post(`${this.url}/${t}/web/pages/${e}/blocks`,r,{headers:i})}updateBlock(t,e,r){const i=(new p.WM).append("x-token",localStorage.getItem("token")||"");return this.http.put(`${this.url}/${t}/web/pages/${e}/blocks/${r._id}`,r,{headers:i})}updateBlockWithID(t,e,r,i){const f=(new p.WM).append("x-token",localStorage.getItem("token")||"");return this.http.put(`${this.url}/${t}/web/pages/${e}/blocks/${r}`,i,{headers:f})}deleteBlock(t,e,r){const i=(new p.WM).append("x-token",localStorage.getItem("token")||"");return this.http.delete(`${this.url}/${t}/web/pages/${e}/blocks/${r}`,{headers:i})}}return h.\u0275fac=function(t){return new(t||h)(n.LFG(p.eN))},h.\u0275prov=n.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()}}]);